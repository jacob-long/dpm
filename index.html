<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Dynamic Panel Models Fit with Maximum Likelihood • dpm</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Dynamic Panel Models Fit with Maximum Likelihood">
<meta property="og:description" content="Implements the dynamic panel models described by Allison, Williams,
 and Moral-Benito (2017 &lt;doi:10.1177/2378023117710578&gt;) in R. 
 This class of models uses structural equation modeling to specify dynamic 
 (lagged dependent variable) models with fixed effects for panel data. 
 Additionally, models may have predictors that are only weakly exogenous, i.e.,
 are affected by prior values of the dependent variable. Options also allow for
 random effects, dropping the lagged dependent variable, and a number of other 
 specification choices.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-home">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">dpm</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">
    <span class="fa fa-file-code-o"></span>
     
    Documentation
  </a>
</li>
<li>
  <a href="news/index.html">
    <span class="fa fa-newspaper-o"></span>
     
    News
  </a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/jacob-long/dpm" class="external-link">
    <span class="fa fa-github fa-lg"></span>
     
    Github
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">

<div class="section level1">
<div class="page-header"><h1 id="dpm">dpm<a class="anchor" aria-label="anchor" href="#dpm"></a>
</h1></div>
<p><a href="https://cran.r-project.org/package=dpm" class="external-link"><img src="https://www.r-pkg.org/badges/version-ago/dpm" alt="CRAN_Status_Badge"></a> <a href="https://github.com/jacob-long/dpm" class="external-link"><img src="https://img.shields.io/github/tag/jacob-long/dpm.svg?label=Github" alt="GitHub tag"></a> <a href="https://cran.r-project.org/package=dpm" class="external-link"><img src="https://cranlogs.r-pkg.org/badges/grand-total/dpm" alt="Total Downloads"></a> <a href="https://github.com/jacob-long/interactions/actions" class="external-link"><img src="https://github.com/jacob-long/dpm/workflows/R-CMD-check/badge.svg" alt="Build Status"></a> <a href="https://app.codecov.io/gh/jacob-long/dpm" class="external-link"><img src="https://codecov.io/gh/jacob-long/dpm/branch/master/graph/badge.svg" alt="codecov"></a> <a href="https://www.repostatus.org/#active" class="external-link"><img src="https://www.repostatus.org/badges/latest/active.svg" alt="Project Status: Active - The project has reached a stable, usable state and is being actively developed."></a> <a href="https://opensource.org/license/mit/" class="external-link"><img src="https://img.shields.io/badge/license-MIT-blue.svg?style=flat" alt="MIT License"></a></p>
<p>This R package implements the dynamic panel data modeling framework described by Allison, Williams, and Moral-Benito (2017). This approach allows fitting models with fixed effects that do not assume strict exogeneity of predictors. That means you can simultaneously get the robustness to confounding offered by fixed effects models and account for reciprocal causation between the predictors and the outcome variable. The estimating approach from Allison et al. provides better finite sample performance in terms of both bias and efficiency than other popular methods (e.g., the Arellano-Bond estimator).</p>
<p>These models are fit using structural equation models, using maximum likelihood estimation and offering the missing data handling and flexibility afforded by SEM. This package will reshape your data, specify the model properly, and fit it with <code>lavaan</code>.</p>
<p>If a result doesn’t seem right, it would be a good idea to cross-reference it with <code>xtdpdml</code> for Stata. Go to <a href="https://www3.nd.edu/~rwilliam/dynamic/" class="external-link uri">https://www3.nd.edu/~rwilliam/dynamic/</a> to learn about <code>xtdpdml</code> and the underlying method. You may also be interested in the article by Paul Allison, Richard Williams, and Enrique Moral-Benito in <strong>Socius</strong>, accessible <a href="http://journals.sagepub.com/doi/full/10.1177/2378023117710578" class="external-link">here</a>.</p>
</div>
<div class="section level1">
<h1 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h1>
<p><code>dpm</code> is now on CRAN and can be installed like other R packages.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"dpm"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level1">
<h1 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a>
</h1>
<p>This package assumes your data are in <em>long</em> format, with each row representing a single observation of a single participant. Contrast this with <em>wide</em> format in which each row contains all observations of a single participant. For help on converting data from wide to long format, check out <a href="https://panelr.jacob-long.com/articles/reshape.html" class="external-link">the tutorial</a> that accompanies the <code>panelr</code> package.</p>
<p>First we load the package and the <code>WageData</code> from <code>panelr</code>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jacob-long/dpm" class="external-link">dpm</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"WageData"</span>, package <span class="op">=</span> <span class="st">"panelr"</span><span class="op">)</span></span></code></pre></div>
<p>This next line of code converts the data to class <code>panel_data</code>, which is a class specific to the <a href="https://github.com/jacob-long/panelr" class="external-link"><code>panelr</code></a> that helps to simplify the treatment of the long-form panel data. You don’t have to do this, but it saves you from providing <code>id</code> and <code>wave</code> arguments to the model fitting function each time you use it.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">wages</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://panelr.jacob-long.com/reference/panel_data.html" class="external-link">panel_data</a></span><span class="op">(</span><span class="va">WageData</span>, id <span class="op">=</span> <span class="va">id</span>, wave <span class="op">=</span> <span class="va">t</span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="basic-formula-syntax">Basic formula syntax<a class="anchor" aria-label="anchor" href="#basic-formula-syntax"></a>
</h2>
<p>The formula syntax used in this package is meant to be as similar to a typical regression model as possible.</p>
<p>The most basic model can be specified like any other: <code>y ~ x</code>, where <code>y</code> is the dependent variable and <code>x</code> is a time-varying predictor. If you would like to include time-invariant predictors, you will make the formula consist of two parts, separated with a bar (<code>|</code>) like so: <code>y ~ x | z</code> where z is a time invariant predictor, like ethnicity.</p>
<p>One of the innovations of the method, however, is the notion of pre-determined, or sequentially exogenous, predictors. To specify a model with a pre-determined variable, put the variable within a <code>pre</code> function, <code>y ~ pre(x1) + x2 | z</code>. This tells the function that <code>x1</code> is pre-determined while <code>x2</code> is strictly exogenous by assumption. You could have multiple pre-determined predictors as well (e.g., <code>y ~ pre(x1) + pre(x2) | z</code>).</p>
<p>You may also fit models with lagged predictors. Simply apply the lag function to the lagged predictors in the formula: <code>y ~ pre(lag(x1)) + lag(x2) | z</code>. To specify more than 1 lag, just provide it as an argument. For instance, <code>y ~ pre(lag(x1, 2)) + lag(x2) | z</code> will use 2 lags of the <code>x1</code> variable.</p>
</div>
<div class="section level2">
<h2 id="socius-article-example">
<em>Socius</em> article example<a class="anchor" aria-label="anchor" href="#socius-article-example"></a>
</h2>
<p>This will replicate the analysis of the wages data in the <em>Socius</em> article that describes these models.</p>
<p>Note that to get matching standard errors, set <code>information = "observed"</code> to override <code>lavaan</code>’s default, <code>information = "expected"</code>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/dpm.html">dpm</a></span><span class="op">(</span><span class="va">wks</span> <span class="op">~</span> <span class="fu">pre</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lag.html" class="external-link">lag</a></span><span class="op">(</span><span class="va">union</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/lag.html" class="external-link">lag</a></span><span class="op">(</span><span class="va">lwage</span><span class="op">)</span> <span class="op">|</span> <span class="va">ed</span>, data <span class="op">=</span> <span class="va">wages</span>,</span>
<span>           error.inv <span class="op">=</span> <span class="cn">TRUE</span>, information <span class="op">=</span> <span class="st">"observed"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>MODEL INFO<span class="sc">:</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>Dependent variable<span class="sc">:</span> wks </span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>Total observations<span class="sc">:</span> <span class="dv">595</span> </span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>Complete observations<span class="sc">:</span> <span class="dv">595</span> </span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>Time periods<span class="sc">:</span> <span class="dv">2</span> <span class="sc">-</span> <span class="dv">7</span> </span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>MODEL FIT<span class="sc">:</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>𝛘²(<span class="dv">76</span>) <span class="ot">=</span> <span class="fl">138.476</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>RMSEA <span class="ot">=</span> <span class="fl">0.037</span>, <span class="dv">90</span>% CI [<span class="fl">0.027</span>, <span class="fl">0.047</span>]</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="fu">p</span>(RMSEA <span class="sc">&lt;</span> .<span class="dv">05</span>) <span class="ot">=</span> <span class="fl">0.986</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>SRMR <span class="ot">=</span> <span class="fl">0.025</span> </span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="sc">|</span>                   <span class="er">|</span>   Est. <span class="sc">|</span>  S.E. <span class="sc">|</span> z val. <span class="sc">|</span>     p <span class="sc">|</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a><span class="er">|:</span><span class="sc">------------------</span><span class="er">|</span><span class="sc">-------</span><span class="er">:|</span><span class="sc">------</span><span class="er">:|</span><span class="sc">-------</span><span class="er">:|</span><span class="sc">------</span><span class="er">:|</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a><span class="er">|</span> <span class="fu">union</span> (t <span class="sc">-</span> <span class="dv">1</span>)     <span class="sc">|</span> <span class="sc">-</span><span class="fl">1.206</span> <span class="sc">|</span> <span class="fl">0.522</span> <span class="sc">|</span> <span class="sc">-</span><span class="fl">2.309</span> <span class="sc">|</span> <span class="fl">0.021</span> <span class="sc">|</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a><span class="er">|</span> <span class="fu">lwage</span> (t <span class="sc">-</span> <span class="dv">1</span>)     <span class="sc">|</span>  <span class="fl">0.588</span> <span class="sc">|</span> <span class="fl">0.488</span> <span class="sc">|</span>  <span class="fl">1.204</span> <span class="sc">|</span> <span class="fl">0.229</span> <span class="sc">|</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a><span class="er">|</span> ed                <span class="sc">|</span> <span class="sc">-</span><span class="fl">0.107</span> <span class="sc">|</span> <span class="fl">0.056</span> <span class="sc">|</span> <span class="sc">-</span><span class="fl">1.893</span> <span class="sc">|</span> <span class="fl">0.058</span> <span class="sc">|</span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a><span class="er">|</span> <span class="fu">wks</span> (t <span class="sc">-</span> <span class="dv">1</span>)       <span class="sc">|</span>  <span class="fl">0.188</span> <span class="sc">|</span> <span class="fl">0.020</span> <span class="sc">|</span>  <span class="fl">9.586</span> <span class="sc">|</span> <span class="fl">0.000</span> <span class="sc">|</span></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>Model converged after <span class="dv">600</span> iterations</span></code></pre></div>
<p>Any arguments supplied other than those that are documented within the <code>dpm</code> function are passed on to <code>sem</code> from the <code>lavaan</code> package.</p>
</div>
<div class="section level2">
<h2 id="model-specification-options">Model specification options<a class="anchor" aria-label="anchor" href="#model-specification-options"></a>
</h2>
<p>The following arguments allow you to make changes to the default model specification:</p>
<ul>
<li>
<code>y.lag</code>: By default the lag 1 value of the DV is included as a predictor (this is why they are dynamic models). You may choose a different value or multiple values instead, including 0 (no lagged DV at all).</li>
<li>
<code>fixed.effects</code>: By default, the model is specified as a fixed effects model. If you set this to FALSE, you get a random effects specification instead.</li>
<li>
<code>error.inv</code>: This constrains error variances to be equal in each wave. It is FALSE by default.</li>
<li>
<code>const.inv</code>: This constrains the constants to be equal in each wave. It is FALSE by default, but if TRUE it eliminates cross-sectional dependence.</li>
<li>
<code>y.free</code>: This allows the regression coefficient of the lagged DV to vary across time. It is FALSE by default and you can either set it to TRUE or to the specific lag number(s).</li>
<li>
<code>x.free</code>: This allows the regression coefficients for the predictors to vary across time. It is FALSE by default and you can either set it to TRUE to set all predictors’ coefficients free over time or else pass a vector of strings of the predictors whose coefficients should be set free over time.</li>
<li>
<code>alpha.free</code>: If TRUE, relaxes the constraint that the fixed effects are equal across time. Default is FALSE to be consistent with how fixed effects models normally work.</li>
<li>
<code>partial.pre</code>: If TRUE (FALSE by default), predetermined lagged predictors will also be allowed to correlate with the contemporaneous error term as <a href="https://statisticalhorizons.com/getting-the-lags-right-a-new-solution/" class="external-link">suggested by Paul Allison</a> for scenarios when it’s not clear whether you have chosen the right lag structure.</li>
</ul>
</div>
<div class="section level2">
<h2 id="summary-options">Summary options<a class="anchor" aria-label="anchor" href="#summary-options"></a>
</h2>
<p>You have most of the options available to you via <code>lavaan</code>’s summary method.</p>
<p>You can choose to omit any of: the <em>z</em> statistics (<code>zstat = FALSE</code>), the standard errors (<code>se = FALSE</code>), or the p values (<code>pvalue = FALSE</code>). You may also add confidence intervals (<code>ci = TRUE</code>) at any specified level (<code>ci.level = .95</code>). If you used bootstrapping for uncertainty intervals, you can also specify the method (<code>boot.ci.type = "perc"</code>).</p>
<p>The number of digits to print can be set via <code>digits</code> or with the option <code>dpm-digits</code>. You may also standardize coefficients via <code>lavaan</code>’s method using <code>standardize = TRUE</code>.</p>
</div>
<div class="section level2">
<h2 id="other-features">Other features<a class="anchor" aria-label="anchor" href="#other-features"></a>
</h2>
<div class="section level3">
<h3 id="lavaan-syntax-only">Lavaan syntax only<a class="anchor" aria-label="anchor" href="#lavaan-syntax-only"></a>
</h3>
<p>If you just want the <code>lavaan</code> model specification and don’t want this package to fit the model for you, you can set <code>print.only = TRUE</code>. To reduce the amount of output, I’m condensing <code>wages</code> to 4 waves here.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/dpm.html">dpm</a></span><span class="op">(</span><span class="va">wks</span> <span class="op">~</span> <span class="fu">pre</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lag.html" class="external-link">lag</a></span><span class="op">(</span><span class="va">union</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/lag.html" class="external-link">lag</a></span><span class="op">(</span><span class="va">lwage</span><span class="op">)</span> <span class="op">|</span> <span class="va">ed</span>, data <span class="op">=</span> <span class="va">wages</span><span class="op">[</span><span class="va">wages</span><span class="op">$</span><span class="va">t</span> <span class="op">&lt;</span> <span class="fl">5</span>,<span class="op">]</span>,</span>
<span>    print.only <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Main regressions</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>wks_2 <span class="sc">~</span> en1 <span class="sc">*</span> union_1 <span class="sc">+</span> ex1 <span class="sc">*</span> lwage_1 <span class="sc">+</span> c1 <span class="sc">*</span> ed <span class="sc">+</span> p1 <span class="sc">*</span> wks_1</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>wks_3 <span class="sc">~</span> en1 <span class="sc">*</span> union_2 <span class="sc">+</span> ex1 <span class="sc">*</span> lwage_2 <span class="sc">+</span> c1 <span class="sc">*</span> ed <span class="sc">+</span> p1 <span class="sc">*</span> wks_2</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>wks_4 <span class="sc">~</span> en1 <span class="sc">*</span> union_3 <span class="sc">+</span> ex1 <span class="sc">*</span> lwage_3 <span class="sc">+</span> c1 <span class="sc">*</span> ed <span class="sc">+</span> p1 <span class="sc">*</span> wks_3</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="do">## Alpha latent variable (random intercept)</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">=</span><span class="er">~</span> <span class="dv">1</span> <span class="sc">*</span> wks_2 <span class="sc">+</span> <span class="dv">1</span> <span class="sc">*</span> wks_3 <span class="sc">+</span> <span class="dv">1</span> <span class="sc">*</span> wks_4</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="do">## Alpha free to covary with observed variables (fixed effects)</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>alpha <span class="sc">~</span><span class="er">~</span>  union_1 <span class="sc">+</span>  union_2 <span class="sc">+</span>  union_3 <span class="sc">+</span>  lwage_1 <span class="sc">+</span>  lwage_2 <span class="sc">+</span>  lwage_3 <span class="sc">+</span>  wks_1</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a><span class="do">## Correlating DV errors with future values of predetermined predictors</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>wks_2 <span class="sc">~</span><span class="er">~</span> union_3</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a><span class="do">## Predetermined predictors covariances</span></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>union_1 <span class="sc">~</span><span class="er">~</span> ed <span class="sc">+</span> lwage_1 <span class="sc">+</span> lwage_2 <span class="sc">+</span> lwage_3 <span class="sc">+</span> wks_1</span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>union_2 <span class="sc">~</span><span class="er">~</span> ed <span class="sc">+</span> lwage_1 <span class="sc">+</span> lwage_2 <span class="sc">+</span> lwage_3 <span class="sc">+</span> union_1 <span class="sc">+</span> wks_1</span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>union_3 <span class="sc">~</span><span class="er">~</span> ed <span class="sc">+</span> lwage_1 <span class="sc">+</span> lwage_2 <span class="sc">+</span> lwage_3 <span class="sc">+</span> union_1 <span class="sc">+</span> union_2 <span class="sc">+</span> wks_1</span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a><span class="do">## Exogenous (time varying and invariant) predictors covariances</span></span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>lwage_1 <span class="sc">~</span><span class="er">~</span> ed <span class="sc">+</span> wks_1</span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>lwage_2 <span class="sc">~</span><span class="er">~</span> ed <span class="sc">+</span> lwage_1 <span class="sc">+</span> wks_1</span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>lwage_3 <span class="sc">~</span><span class="er">~</span> ed <span class="sc">+</span> lwage_1 <span class="sc">+</span> lwage_2 <span class="sc">+</span> wks_1</span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a>ed <span class="sc">~</span><span class="er">~</span> wks_1</span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a><span class="do">## DV error variance free to vary across waves</span></span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a>wks_2 <span class="sc">~</span><span class="er">~</span> wks_2</span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a>wks_3 <span class="sc">~</span><span class="er">~</span> wks_3</span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a>wks_4 <span class="sc">~</span><span class="er">~</span> wks_4</span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a><span class="do">## Let DV variance vary across waves</span></span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-41"><a href="#cb7-41" aria-hidden="true" tabindex="-1"></a>wks_2 <span class="sc">~</span> <span class="dv">1</span></span>
<span id="cb7-42"><a href="#cb7-42" aria-hidden="true" tabindex="-1"></a>wks_3 <span class="sc">~</span> <span class="dv">1</span></span>
<span id="cb7-43"><a href="#cb7-43" aria-hidden="true" tabindex="-1"></a>wks_4 <span class="sc">~</span> <span class="dv">1</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="extract-components">Extract components<a class="anchor" aria-label="anchor" href="#extract-components"></a>
</h3>
<p>Alternately, you can extract the <code>lavaan</code> model syntax and wide-formatted data from the fitted model object to do your own fitting and tweaking.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/get_wide_data.html">get_wide_data</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/get_syntax.html">get_syntax</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></code></pre></div>
<p>The model is a special type of <code>lavaan</code> object. This means most methods implemented for <code>lavaan</code> objects will work on these. You can also convert the fitted model into a typical <code>lavaan</code> object:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/methods/as.html" class="external-link">as</a></span><span class="op">(</span><span class="va">fit</span>, <span class="st">"lavaan"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="get-full-lavaan-summary">Get full <code>lavaan</code> summary<a class="anchor" aria-label="anchor" href="#get-full-lavaan-summary"></a>
</h3>
<p>While you could convert the model to <code>lavaan</code> model and apply any of <code>lavaan</code>’s functions to it (and you should!), as a convenience you can use <code><a href="reference/lavaan-functions.html">lav_summary()</a></code> to get <code>lavaan</code>’s summary of the model.</p>
</div>
<div class="section level3">
<h3 id="missing-data">Missing data<a class="anchor" aria-label="anchor" href="#missing-data"></a>
</h3>
<p>Take advantage of <code>lavaan</code>’s missing data handling by using the <code>missing = "fiml"</code> argument as well as any other arguments accepted by <code><a href="https://rdrr.io/pkg/lavaan/man/sem.html" class="external-link">lavaan::sem()</a></code>.</p>
</div>
</div>
</div>
<div class="section level1">
<h1 id="feature-comparison-and-roadmap">Feature comparison and roadmap<a class="anchor" aria-label="anchor" href="#feature-comparison-and-roadmap"></a>
</h1>
<ul>
<li>CFI/TLI fit measures are much different than Stata’s and consistently more optimistic. For now, they are not printed with the summary because they are probably misleading.</li>
<li>
<del>You cannot use multiple lags of the same predictor (e.g., <code>y ~ x + lag(x)</code>).</del> (Fixed in <code>1.0.0</code>)</li>
<li>The function does not yet support input data that is already in wide format. (Not planning to fix)</li>
<li>
<del>You cannot apply arbitrary functions to variables in the formula like you can with regression models. For instance, a specification like <code>y ~ scale(x)</code> will cause an error.</del> (Works as of <code>1.1.0</code>)</li>
</ul>
<p>Feature parity with <code>xtdpdml</code> (Stata) is a goal. Here’s how we are doing in terms of matching relevant <code>xtdpdml</code> options:</p>
<ul class="task-list">
<li>
<input type="checkbox" disabled checked><code>alphafree</code> (as <code>alpha.free</code>)</li>
<li>
<input type="checkbox" disabled checked><code>xfree</code> (as <code>x.free</code>)</li>
<li>
<input type="checkbox" disabled checked><code>xfree(varlist)</code> (as <code>x.free</code>)</li>
<li>
<input type="checkbox" disabled checked><code>yfree</code> (added as <code>y.free</code> argument in <code>1.0.0</code>)</li>
<li>
<input type="checkbox" disabled><code>yfree(numlist)</code>
</li>
<li>
<input type="checkbox" disabled checked><code>re</code> (added via <code>fixed.effects</code> argument in <code>1.0.0</code>)</li>
<li>
<input type="checkbox" disabled checked><code>errorinv</code> (as <code>error.inv</code>)</li>
<li>
<input type="checkbox" disabled checked><code>nocsd</code>/<code>constinv</code> (as <code>const.inv</code>)</li>
<li>
<input type="checkbox" disabled checked><code>ylag(numlist)</code> (added as <code>y.lag</code> argument in <code>1.0.0</code>; option to specify as 0 — no lagged DV — added in <code>1.1.0</code>)</li>
<li>
<input type="checkbox" disabled><code>std</code> (but <code>standardize</code> argument of <code>summary</code> may suffice)</li>
<li>
<input type="checkbox" disabled checked><code>dryrun</code> (as <code>print.only</code>)</li>
</ul>
<p>Many and perhaps more SEM fitting options are implemented by virtue of accepting any <code><a href="https://rdrr.io/pkg/lavaan/man/sem.html" class="external-link">lavaan::sem()</a></code> argument.</p>
<div class="section level2">
<h2 id="roadmap">Roadmap<a class="anchor" aria-label="anchor" href="#roadmap"></a>
</h2>
<ul class="task-list">
<li>
<input type="checkbox" disabled>Get proper CFI/TLI statistics — this is a <code>lavaan</code> problem.</li>
<li>
<input type="checkbox" disabled checked>Allow full use of formula syntax, e.g. <code>y ~ scale(x)</code> (fixed in <code>1.1.0</code>)</li>
<li>
<input type="checkbox" disabled checked>Add <code>broom</code> methods (<code>tidy</code>, <code>glance</code>) (added <code>tidy</code> in <code>1.1.0</code>)</li>
<li>
<input type="checkbox" disabled>Create a <code>predict</code> method and perhaps some ability to plot predictions</li>
<li>
<input type="checkbox" disabled checked>Add <code>x.free</code> option to allow the coefficients of all predictors to vary across periods. This will make the <code>summary</code> output a pain, so it will take some time to implement. (added in <code>1.1.1</code>)</li>
</ul>
</div>
</div>
<div class="section level1">
<h1 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h1>
<p>Allison, P. (2022, October 24). Getting the lags right – a new solution. <em>Statistical Horizons</em>. <a href="https://statisticalhorizons.com/getting-the-lags-right-a-new-solution/" class="external-link uri">https://statisticalhorizons.com/getting-the-lags-right-a-new-solution/</a></p>
<p>Allison, P. D., Williams, R., &amp; Moral-Benito, E. (2017). Maximum likelihood for cross-lagged panel models with fixed effects. <em>Socius</em>, <em>3</em>, 1–17. <a href="https://doi.org/10.1177/2378023117710578" class="external-link uri">https://doi.org/10.1177/2378023117710578</a></p>
<p>Leszczensky, L., &amp; Wolbring, T. (2022). How to deal with reverse causality using panel data? Recommendations for researchers based on a simulation study. <em>Sociological Methods &amp; Research</em>, <em>51</em>(2), 837–865. <a href="https://doi.org/10.1177/0049124119882473" class="external-link uri">https://doi.org/10.1177/0049124119882473</a></p>
<p>Moral-Benito, E., Allison, P., &amp; Williams, R. (2019). Dynamic panel data modelling using maximum likelihood: An alternative to Arellano-Bond. <em>Applied Economics</em>, <em>51</em>, 2221–2232. <a href="https://doi.org/10.1080/00036846.2018.1540854" class="external-link uri">https://doi.org/10.1080/00036846.2018.1540854</a></p>
<p>Williams, R., Allison, P. D., &amp; Moral-Benito, E. (2018). Linear dynamic panel-data estimation using maximum likelihood and structural equation modeling. <em>The Stata Journal</em>, <em>18</em>, 293–326. <a href="https://doi.org/10.1177/1536867X1801800201" class="external-link uri">https://doi.org/10.1177/1536867X1801800201</a></p>
</div>

  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=dpm" class="external-link">View on CRAN</a></li>
<li><a href="https://github.com/jacob-long/dpm/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/jacob-long/dpm/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li>
<a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a>
</li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing dpm</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>
<a href="https://jacob-long.com" class="external-link">Jacob A. Long</a> <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0002-1582-6214" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>
<a href="https://www3.nd.edu/~rwilliam/" class="external-link">Richard A. Williams</a> <br><small class="roles"> Author </small>  </li>
<li>
<a href="https://statisticalhorizons.com/our-instructors/paul-allison" class="external-link">Paul D. Allison</a> <br><small class="roles"> Author </small> <a href="https://orcid.org/0000-0002-0646-5242" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>



  </div>
</div>


      <footer><div class="copyright">
  <p></p>
<p>Developed by <a href="https://jacob-long.com" class="external-link">Jacob A. Long</a>, <a href="https://www3.nd.edu/~rwilliam/" class="external-link">Richard A. Williams</a>, <a href="https://statisticalhorizons.com/our-instructors/paul-allison" class="external-link">Paul D. Allison</a>.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
